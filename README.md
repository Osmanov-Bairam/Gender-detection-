
# **Предсказание пола клиента**

## **Введение**

Необходимо было выявить пол клиента, основываясь на его транзакционных исторических данных. В роли метрики качества выступает [ROC AUC].

## **Задачи**

•	Разработать модель бинарной классификации для определения пола клиента. Главное, чтобы ROC AUC на отложенном тесте получился выше 77.5%.
•	Интерпретировать результаты модели: важность входящих в нее переменных, демонстрация на нескольких примерах, почему получился соответствующий прогноз.
•	Конвертировать результаты в отчет без кода.

## **Подготовка**

### **Данные были разделены на 5 групп.**

1.	**Репрезентативная выборка**, состоящая из 100 000 записей. Она была создана для быстрой оценки данных. Основываясь на этой выборке, я произвел:
  a.	Анализ данных.
  b.	Сравнение различных алгоритмов по скорости обучения и ROC AUC.
2.	**Полная выборка**, состоящая из 3 700 000 записей. Основываясь на этой выборке, я произвел:
  a.	Финальное обучение модели.
  b.	Оценку важности признаков клиентов.
  c.	Подбор гиперпарметров (оставил на потом из-за нехватки ресурсов)
3.	**Тестовая выборка**, состоящая из 3 100 000 записей. Основываясь на этой выборке, я произвел:
  a.	Финальное предсказание, которое будет использоваться для оценки моей работы HR.
4.	**Тренировочная и валидационная выборка**, состоящая из 1 850 000 записей каждая. Основываясь на этих выборках, я произвел:
  a.	Проверку точности предсказаний на данных, которую модель не видела. Данная оценка нужна была уверенности в хороших предсказаниях модели до проверки на тестовой выборке.

### **Данные были предварительно обработаны**

1.	Найдены отсутствующие данные для признака - term_id (идентификатор терминала). Использовались 2 метода:
  a.	Случайный выбор категории с учетом его распределения в тренировочных данных. Подробности в блокноте.
  b.	Добавления индикатора к каждому наблюдению, где отсутствовал признак.
2.	Было создано - - новых признаков.
3.	Редкие категории объединены в общую группу Rare.
    До

    После
4.	Категориальные признаки были закодированы. Каждый признак был заменен на число, характеризующий частоту появления даного признака в тренировочных данных.
5.	Произведена проверка наличие утечки данных на этапе обработки.

## **Выбор модели**

В качестве финальной модели был выбран RF, у которого оптимальное время обучение и точность предсказаий. 
Картинка

## **Топ 13 признаков** 

Все признаки были отфильтрованы. Для фильтрации был создан признак со случайными числами на этапе генерации новых признаков.
Картинка

 'Mean_net_money_per_day'  = средняя сумма транзакции за все время одним клиентом.
 'Std_net_money_per_day' = среднее отклонение 'Mean_net_money_per_day' одним клиентом.
 'Mean_spend_money_per_day' = средняя отрицательная транзакция за все время одним клиентом.
 'Mean_earn_money_per_day' = средняя положительная транзакция за все время одним клиентом.
 'Money_spend_std_per_day' = среднее отклонение 'Mean_spend_money_per_day' одним клиентом.
 'Mean_earn_std_per_day' = среднее отклонение 'Mean_earn_money_per_day' одним клиентом.
 'Money_earn_spend_ratio_per_day' = отношение средней положительной и отрицательной транзакции за все время одним клиентом.
 'ALL_money_net' = общая сумма транзакций за все время одним клиентом.
 'ALL_money_spend' = общая сумма отрицательных транзакций за все время одним клиентом.
 'ALL_money_earn' = общая сумма положительных транзакций за все время одним клиентом.
 'ALL_money_spend_earn_ratio' = отношение общих отрицательных и положительных сумм транзакций 
 'Frequency_of_spending_all' = частота свершения транзакций за день
 'Frequency_of_spending_per_week' = частота свершения транзакций за неделю
 
## **Интерпретация признаков**

Картинка

## **Результаты**

Финальный ROC AUC на валидации по 4KFOLD в среднем – 0.9429.
Финальные ответ для тестовой выборки сохранен в таблице в разделе FOR ASSESMENT

## **Будущие улучшения**

1.	Подобрать гиперпараметры для лучшей генерализации предсказаний
2.	Использовать нейронные сети для генерации признаков
